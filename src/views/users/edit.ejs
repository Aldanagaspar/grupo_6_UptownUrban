<!DOCTYPE html>
<html lang="en">

<%- include('../partials/head.ejs', {titulo: 'Editar perfil - Uptown Urban' , css: 'registro' })%>

    <body>
        <%- include("../partials/header.ejs") %>
            <main>
                
                <div class="container">
                    <form action="/users/profile/edit?_method=PUT" method="POST" enctype="multipart/form-data" class="edit">
                        <label for="fullname">Nombres y Apellido</label>
                        <div>
                            <input id="fullname" name="fullname" type="text" placeholder= "Nuevo Nombre" value="<%= user.fullname %>"><br>
                            <p class="error" id="error_fullname" style ="display: none">Ingrese un Nombre</p>
                            <p class="error" id="error_fullname_length" style ="display: none">El nombre tiene que tener mas de 5 caracteres</p>
                        </div>
                        <label for="password">Contraseña</label>
                        <div>
                            <input id="password" name="password" type="password"><br>
                            <p class="error" id="error_password" style ="display: none">Ingrese una Contraseña</p>
                            <p class="error" id="error_password_length" style ="display: none">La contraseña tiene que tener mas de 5 caracteres</p>
                        </div>
                        <label for="profilePicture">Foto de Perfil</label>
                        <input id="profilePicture" name="profilePicture" type="file" value="<%= user.profilePicture %>"><br>
                        <button type="submit" class="boton-primario">¡Guardar Cambios!</button>
                    </form>
                </div>
                </div>
            </main>
            <%- include("../partials/footer.ejs") %>
    </body>
    <script >
        window.addEventListener("load", function(){
            let formulario = document.querySelector("form.edit");
            let fullname = document.querySelector("#fullname");
            let password = document.querySelector("#password");

            formulario.addEventListener("submit", function(e){
                if (fullname.value == "" || fullname.value.length < 5 || password.value == "" || password.value.length < 5){
                    alert("Complete el formulario")
                    
                }else{
                    alert("El perfil se edito perfectamente")  
                }
                e.preventDefault();
            });
            fullname.addEventListener("blur", function(e){
                document.querySelector("#error_fullname").style.display ="none";
                document.querySelector("#error_fullname_length").style.display ="none";
                if (fullname.value == ""){
                    document.querySelector("#error_fullname").style.display ="block";
                    return
                }else{
                    document.querySelector("#error_fullname").style.display ="none";
                }
                if (fullname.value.length < 5){
                    document.querySelector("#error_fullname_length").style.display ="block";
                    return
                }else{
                    document.querySelector("#error_fullname_length").style.display ="none";
                } 
            })
            password.addEventListener("blur", function(e){
                document.querySelector("#error_password").style.display ="none";
                document.querySelector("#error_password_length").style.display ="none";
                if (password.value == ""){
                    document.querySelector("#error_password").style.display ="block";
                    return
                }else{
                    document.querySelector("#error_password").style.display ="none";
                }
                if (password.value.length < 5){
                    document.querySelector("#error_password_length").style.display ="block";
                    return
                }else{
                    document.querySelector("#error_password_length").style.display ="none";
                } 
            })
        });
    </script>
</html>